import subprocess, re

def versao_edge_instalada():
    try:
        # Tenta pegar pelo registro
        out = subprocess.check_output(
            r'reg query "HKEY_CURRENT_USER\Software\Microsoft\Edge\BLBeacon" /v version',
            shell=True, text=True
        )
        return re.search(r"(\d+\.\d+\.\d+\.\d+)", out).group(1)
    except:
        # fallback: usar comando do edge
        out = subprocess.check_output("msedge --version", shell=True, text=True)
        return re.search(r"(\d+\.\d+\.\d+\.\d+)", out).group(1)

import requests, zipfile, io, pathlib

versao = versao_edge_instalada()
major = versao.split(".")[0]
url_version = f"https://msedgedriver.azureedge.net/LATEST_RELEASE_{major}"
versao_driver = requests.get(url_version).text.strip()

zip_url = f"https://msedgedriver.azureedge.net/{versao_driver}/edgedriver_win64.zip"
r = requests.get(zip_url)
zf = zipfile.ZipFile(io.BytesIO(r.content))
destino = pathlib.Path("drivers/edgedriver")
destino.mkdir(parents=True, exist_ok=True)
zf.extractall(destino)
print("Driver baixado e extra√≠do em:", destino)
